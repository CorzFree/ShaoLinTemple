{"version":3,"sources":["../../../../../assets/common/lobby/assets/common/lobby/roomUserInfo.js"],"names":["mvs","require","GLB","cc","Class","extends","Component","properties","userName","default","type","Label","ownerTag","Node","otherTag","selfTag","defaultNode","commonNode","kick","init","active","string","on","kickPlayer","userId","clientEvent","eventType","playerAccountGet","userInfoSet","setData","ownerId","userInfo","id","isRoomOwner","Game","GameManager","userInfoReq","recvMsg","console","log","account","headIcon","loader","load","url","err","texture","spriteFrame","SpriteFrame","Rect","width","height","userIcon","bind","onDestroy","off","engine"],"mappings":"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","file":"roomUserInfo.js","sourceRoot":"../../../../../assets/common/lobby","sourcesContent":["var mvs = require(\"Matchvs\");\nvar GLB = require(\"Glb\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        userName: {\n            default: null,\n            type: cc.Label\n        },\n        ownerTag: {\n            default: null,\n            type: cc.Node\n        },\n        otherTag: {\n            default: null,\n            type: cc.Node\n        },\n        selfTag: {\n            default: null,\n            type: cc.Node\n        },\n        defaultNode: {\n            default: null,\n            type: cc.Node\n        },\n        commonNode: {\n            default: null,\n            type: cc.Node\n        },\n        kick: {\n            default: null,\n            type: cc.Node\n        }\n    },\n\n    init: function() {\n        this.defaultNode.active = true;\n        this.otherTag.active = false;\n        this.ownerTag.active = false;\n        this.selfTag.active = false;\n        this.userName.string = '';\n        this.commonNode.active = false;\n        this.kick.active = false;\n        this.kick.on(\"click\", this.kickPlayer, this);\n        this.userId = 0;\n        clientEvent.on(clientEvent.eventType.playerAccountGet, this.userInfoSet, this);\n    },\n\n    setData: function(userId, ownerId) {\n        this.userId = userId;\n        if (this.userId === ownerId) {\n            this.ownerTag.active = true;\n            this.otherTag.active = false;\n            this.selfTag.active = false;\n        } else if (this.userId === GLB.userInfo.id) {\n            this.ownerTag.active = false;\n            this.otherTag.active = false;\n            this.selfTag.active = true;\n        } else {\n            this.ownerTag.active = false;\n            this.otherTag.active = true;\n            this.selfTag.active = false;\n        }\n        this.defaultNode.active = false;\n        this.commonNode.active = true;\n        this.userName.string = this.userId;\n\n        if (!GLB.isRoomOwner || this.userId === GLB.userInfo.id) {\n            this.kick.active = false;\n        } else {\n            this.kick.active = true;\n        }\n        Game.GameManager.userInfoReq(this.userId);\n    },\n\n    userInfoSet: function(recvMsg) {\n        console.log(\"recvMsg:\" + recvMsg);\n        if (recvMsg.account == this.userId) {\n            console.log(\"set user info\");\n            console.log(recvMsg);\n            this.userName.string = recvMsg.userName;\n            if (recvMsg.headIcon && recvMsg.headIcon !== \"-\") {\n                cc.loader.load({url: recvMsg.headIcon, type: 'png'}, function(err, texture) {\n                    var spriteFrame = new cc.SpriteFrame(texture, cc.Rect(0, 0, texture.width, texture.height));\n                    this.userIcon.spriteFrame = spriteFrame;\n                }.bind(this));\n            }\n        }\n    },\n\n    onDestroy() {\n        clientEvent.off(clientEvent.eventType.playerAccountGet, this.userInfoSet, this);\n    },\n\n    kickPlayer: function() {\n        mvs.engine.kickPlayer(this.userId, \"kick\");\n    }\n});\n"]}