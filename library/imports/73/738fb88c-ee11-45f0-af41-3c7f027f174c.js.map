{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\common\\script/assets\\common\\script\\uiGamePanel.js"],"names":["mvs","require","GLB","Appear_Role","None","Brother","Teacher","Besom","Door","cc","Class","extends","properties","hitAudio","default","url","AudioClip","laughAudio","closeDoorSmall","closeDoorAll","standUpAuido","besomNode","Node","brotherNode","teacherNode","shutDoorSprite","SpriteFrame","halfDoorSprite","hitButtonNode","complacentButtonNode","addRedPrefab","Prefab","reduceRedPrefab","addBluePrefab","reduceBluePrefab","redNumParent","blueNumParent","redScoreNode","blueScoreNode","timeNode","selfNode","otherNode","selfIcon","rivalIcon","onLoad","_super","curAppearRole","totalInterval","curInterval","besomAnim","getComponent","Animation","besomAnimName","brotherAnim","brotherAudio","AudioSource","brotherAnimName","teacherAnim","teacherAudio","halfDoorAnimName","openDoorAnimName","closeDoorAnimName","on","roleAlreadyAppear","redScoreLabel","Label","blueScoreLabel","timeLabel","clientEvent","eventType","appearBesom","appearBrother","appearTeacher","halfOpenDoor","standUpEvent","sitDown","showAddRedNum","showReduceRedNum","showBlueAddNum","showReduceBlueNum","hitEvent","hit","complacentEvent","complacent","gameOver","roundStart","leaveRoomNotify","leaveRoom","isPersonAppear","isNeedTiming","isPlayerStandUp","totalStandUpTime","curStandUpTime","addredNumPool","reduceRedNumPool","addBlueNumPool","reduceBlueNumPool","createPool","selfScore","otherScore","updateSelfScore","updateOtherScore","totalTime","curTime","timer","console","log","nodeDict","setData","id","playerUserIds","self","other","exit","data","Game","GameManager","gameState","GameState","Over","uiFunc","openUI","obj","uiTip","leaveRoomInfo","userId","userInfo","bind","play","setTimeout","countDownEvent","clearInterval","countDown","setInterval","Play","string","toString","isRoomOwner","msg","action","GAME_OVER_EVENT","sendEventEx","num","NodePool","i","addRedItem","instantiate","reduceRedItem","addBlueItem","reduceBlueItem","put","getPoolItem","pool","prefab","item","size","get","score","parent","init","event","detail","name","wrapMode","param","dispatch","standUpEventMed","playerState","Player_State","StandUp","active","sitDownEvent","SIT_DOWN","STAND_UP","PLAYER_HIT","audioEngine","COMPLACENT","laughId","state","getState","AudioState","PLAYING","randomAppearRole","Math","random","role","randomNumBoth","Min","Max","Range","Rand","round","appearRole","APPEAR_BESOM","APPEAR_BROTHER","APPEAR_TEACHER","HALF_OPEN_DOOR","anim","WrapMode","Normal","Reverse","update","dt","onDestroy","off"],"mappings":"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","file":"uiGamePanel.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\common\\script","sourcesContent":["var mvs = require(\"Matchvs\");\r\nvar GLB = require(\"Glb\");\r\nvar Appear_Role = {\r\n    None: 0,\r\n    Brother: 1,\r\n    Teacher: 2,\r\n    Besom: 3,\r\n    Door: 4\r\n};\r\ncc.Class({\r\n    extends: require(\"uiPanel\"),\r\n\r\n    properties: {\r\n        hitAudio: {\r\n            default: null,\r\n            url: cc.AudioClip\r\n        },\r\n        laughAudio: {\r\n            default: null,\r\n            url: cc.AudioClip\r\n        },\r\n        closeDoorSmall: {\r\n            default: null,\r\n            url: cc.AudioClip\r\n        },\r\n        closeDoorAll: {\r\n            default: null,\r\n            url: cc.AudioClip\r\n        },\r\n        standUpAuido: {\r\n            default: null,\r\n            url: cc.AudioClip\r\n        },\r\n        besomNode: cc.Node,\r\n        brotherNode: cc.Node,\r\n        teacherNode: cc.Node,\r\n        shutDoorSprite: cc.SpriteFrame,\r\n        halfDoorSprite: cc.SpriteFrame,\r\n        hitButtonNode: cc.Node,\r\n        complacentButtonNode: cc.Node,\r\n        addRedPrefab: cc.Prefab,\r\n        reduceRedPrefab: cc.Prefab,\r\n        addBluePrefab: cc.Prefab,\r\n        reduceBluePrefab: cc.Prefab,\r\n        redNumParent: cc.Node,\r\n        blueNumParent: cc.Node,\r\n        redScoreNode: cc.Node,\r\n        blueScoreNode: cc.Node,\r\n        timeNode: cc.Node,\r\n        selfNode: cc.Node,\r\n        otherNode: cc.Node,\r\n        selfIcon: cc.Node,\r\n        rivalIcon: cc.Node\r\n    },\r\n\r\n    onLoad() {\r\n        this._super();\r\n        this.curAppearRole = Appear_Role.None;\r\n        this.totalInterval = 6;\r\n        this.curInterval = 0;\r\n        this.besomAnim = this.besomNode.getComponent(cc.Animation);\r\n        this.besomAnimName = 'broom';\r\n        this.brotherAnim = this.brotherNode.getComponent(cc.Animation);\r\n        this.brotherAudio = this.brotherNode.getComponent(cc.AudioSource);\r\n        this.brotherAnimName = 'teacherBro';\r\n        this.teacherAnim = this.teacherNode.getComponent(cc.Animation);\r\n        this.teacherAudio = this.teacherNode.getComponent(cc.AudioSource);\r\n\r\n        this.halfDoorAnimName = 'noOpen';\r\n        this.openDoorAnimName = 'openDoo';\r\n        this.closeDoorAnimName = 'close';\r\n\r\n        this.brotherAnim.on('finished', this.roleAlreadyAppear, this);\r\n        this.teacherAnim.on('finished', this.roleAlreadyAppear, this);\r\n        this.besomAnim.on('finished', this.roleAlreadyAppear, this);\r\n        this.redScoreLabel = this.redScoreNode.getComponent(cc.Label);\r\n        this.blueScoreLabel = this.blueScoreNode.getComponent(cc.Label);\r\n        this.timeLabel = this.timeNode.getComponent(cc.Label);\r\n        clientEvent.on(clientEvent.eventType.appearBesom, this.appearBesom, this);\r\n        clientEvent.on(clientEvent.eventType.appearBrother, this.appearBrother, this);\r\n        clientEvent.on(clientEvent.eventType.appearTeacher, this.appearTeacher, this);\r\n        clientEvent.on(clientEvent.eventType.halfOpenDoor, this.halfOpenDoor, this);\r\n        clientEvent.on(clientEvent.eventType.standUpEvent, this.standUpEvent, this);\r\n        clientEvent.on(clientEvent.eventType.sitDown, this.sitDown, this);\r\n        clientEvent.on(clientEvent.eventType.showAddRedNum, this.showAddRedNum, this);\r\n        clientEvent.on(clientEvent.eventType.showReduceRedNum, this.showReduceRedNum, this);\r\n        clientEvent.on(clientEvent.eventType.showBlueAddNum, this.showBlueAddNum, this);\r\n        clientEvent.on(clientEvent.eventType.showReduceBlueNum, this.showReduceBlueNum, this);\r\n        clientEvent.on(clientEvent.eventType.hitEvent, this.hit, this);\r\n        clientEvent.on(clientEvent.eventType.complacentEvent, this.complacent, this);\r\n        clientEvent.on(clientEvent.eventType.gameOver, this.gameOver, this);\r\n        clientEvent.on(clientEvent.eventType.roundStart, this.roundStart, this);\r\n        clientEvent.on(clientEvent.eventType.leaveRoomNotify, this.leaveRoom, this);\r\n        this.isPersonAppear = false;\r\n        this.isNeedTiming = true;\r\n        this.isPlayerStandUp = false;\r\n        this.totalStandUpTime = 3;\r\n        this.curStandUpTime = 0;\r\n        this.addredNumPool = null;\r\n        this.reduceRedNumPool = null;\r\n        this.addBlueNumPool = null;\r\n        this.reduceBlueNumPool = null;\r\n        this.createPool();\r\n        this.selfScore = 0;\r\n        this.otherScore = 0;\r\n        this.updateSelfScore(0);\r\n        this.updateOtherScore(0);\r\n        this.totalTime = 60;\r\n        this.curTime = 60;\r\n        this.timer = null;\r\n\r\n        console.log(\"----------------\");\r\n        console.log(this.nodeDict);\r\n        console.log(this.selfIcon);\r\n        this.selfIcon.getComponent('playerIcon').setData({id: GLB.playerUserIds[0]});\r\n        this.rivalIcon.getComponent('playerIcon').setData({id: GLB.playerUserIds[1]});\r\n        this.self = this.selfNode.getComponent('player');\r\n        this.other = this.otherNode.getComponent('player');\r\n\r\n        this.nodeDict[\"exit\"].on(\"click\", this.exit, this);\r\n    },\r\n\r\n    leaveRoom(data) {\r\n        if (Game.GameManager.gameState !== GameState.Over) {\r\n            uiFunc.openUI(\"uiTip\", function(obj) {\r\n                var uiTip = obj.getComponent(\"uiTip\");\r\n                if (uiTip) {\r\n                    if (data.leaveRoomInfo.userId !== GLB.userInfo.id) {\r\n                        uiTip.setData(\"对手离开了游戏\");\r\n                    }\r\n                }\r\n            }.bind(this));\r\n        }\r\n    },\r\n\r\n    roundStart: function() {\r\n        // 回合画面表现--\r\n        this.nodeDict['readyGo'].getComponent(cc.Animation).play();\r\n        this.nodeDict['readyGo'].getComponent(cc.AudioSource).play();\r\n\r\n        setTimeout(function() {\r\n            this.countDownEvent();\r\n        }.bind(this), 2500);\r\n    },\r\n\r\n    gameOver() {\r\n        this.nodeDict['gameOver'].getComponent(cc.Animation).play();\r\n        this.nodeDict['gameOver'].getComponent(cc.AudioSource).play();\r\n        clearInterval(this.timer);\r\n    },\r\n\r\n    exit() {\r\n        uiFunc.openUI(\"uiExit\");\r\n    },\r\n\r\n    countDownEvent() {\r\n        this.countDown();\r\n        this.timer = setInterval(this.countDown.bind(this), 1000);\r\n    },\r\n    countDown() {\r\n        if (Game.GameManager.gameState !== GameState.Play) {\r\n            clearInterval(this.timer);\r\n            return;\r\n        }\r\n        this.timeLabel.string = this.curTime.toString();\r\n        if (this.curTime <= 0) {\r\n            clearInterval(this.timer);\r\n            if (GLB.isRoomOwner && Game.GameManager.gameState === GameState.Play) {\r\n                var msg = {action: GLB.GAME_OVER_EVENT};\r\n                Game.GameManager.sendEventEx(msg);\r\n            }\r\n            return;\r\n        }\r\n        if (this.curTime === 10) {\r\n            this.nodeDict[\"countdown\"].getComponent(cc.Animation).play(\"countdown7\");\r\n        } else if (this.curTime === 3) {\r\n            this.nodeDict[\"countdown\"].getComponent(cc.Animation).play(\"countdown3\");\r\n        }\r\n        this.curTime--;\r\n    },\r\n    updateSelfScore(num) {\r\n        this.selfScore += num;\r\n        if (this.selfScore < 0) {\r\n            this.selfScore = 0;\r\n        }\r\n        this.blueScoreLabel.string = this.selfScore.toString();\r\n    },\r\n    updateOtherScore(num) {\r\n        this.otherScore += num;\r\n        if (this.otherScore < 0) {\r\n            this.otherScore = 0;\r\n        }\r\n        this.redScoreLabel.string = this.otherScore.toString();\r\n    },\r\n    createPool() {\r\n        this.addredNumPool = new cc.NodePool();\r\n        this.reduceRedNumPool = new cc.NodePool();\r\n        this.addBlueNumPool = new cc.NodePool();\r\n        this.reduceBlueNumPool = new cc.NodePool();\r\n        for (var i = 0; i < 10; i++) {\r\n            var addRedItem = cc.instantiate(this.addRedPrefab);\r\n            var reduceRedItem = cc.instantiate(this.reduceRedPrefab);\r\n            var addBlueItem = cc.instantiate(this.addBluePrefab);\r\n            var reduceBlueItem = cc.instantiate(this.reduceBluePrefab);\r\n            this.addredNumPool.put(addRedItem);\r\n            this.reduceRedNumPool.put(reduceRedItem);\r\n            this.addBlueNumPool.put(addBlueItem);\r\n            this.reduceBlueNumPool.put(reduceBlueItem);\r\n        }\r\n    },\r\n    getPoolItem(pool, prefab) {\r\n        var item = null;\r\n        if (pool.size() > 0) {\r\n            item = pool.get();\r\n        } else {\r\n            item = cc.instantiate(prefab);\r\n        }\r\n        return item;\r\n    },\r\n    showAddRedNum() {\r\n        var item = this.getPoolItem(this.addredNumPool, this.addRedPrefab);\r\n        var score = item.getComponent('updateScore');\r\n        item.parent = this.redNumParent;\r\n        score.init(this.addredNumPool);\r\n        this.updateOtherScore(1);\r\n    },\r\n    showReduceRedNum() {\r\n        var item = this.getPoolItem(this.reduceRedNumPool, this.reduceRedPrefab);\r\n        var score = item.getComponent('updateScore');\r\n        item.parent = this.redNumParent;\r\n        score.init(this.reduceRedNumPool);\r\n        this.updateOtherScore(-2);\r\n    },\r\n    showBlueAddNum() {\r\n        var item = this.getPoolItem(this.addBlueNumPool, this.addBluePrefab);\r\n        var score = item.getComponent('updateScore');\r\n        item.parent = this.blueNumParent;\r\n        score.init(this.addBlueNumPool);\r\n        this.updateSelfScore(1);\r\n    },\r\n    showReduceBlueNum() {\r\n        var item = this.getPoolItem(this.reduceBlueNumPool, this.reduceBluePrefab);\r\n        var score = item.getComponent('updateScore');\r\n        item.parent = this.blueNumParent;\r\n        score.init(this.reduceBlueNumPool);\r\n        this.updateSelfScore(-2);\r\n    },\r\n    roleAlreadyAppear(event) {\r\n        if (event.detail.name === this.openDoorAnimName || event.detail.name === this.brotherAnimName) {\r\n            if (event.detail.wrapMode === 1) {\r\n                this.isPersonAppear = true;\r\n            } else {\r\n                this.isNeedTiming = true;\r\n            }\r\n        }\r\n        if (event.detail.name === this.halfDoorAnimName || event.detail.name === this.besomAnimName) {\r\n            this.isNeedTiming = true;\r\n        }\r\n\r\n\r\n    },\r\n    standUpEvent(param) {\r\n        clientEvent.dispatch(clientEvent.eventType.standUpEventMed, param);\r\n        if (this.self.playerState === Player_State.StandUp) {\r\n            this.complacentButtonNode.active = false;\r\n        } else {\r\n            if (this.other.playerState === Player_State.StandUp) {\r\n                this.complacentButtonNode.active = true;\r\n            } else {\r\n                this.complacentButtonNode.active = false;\r\n            }\r\n        }\r\n        this.hitButtonNode.active = false;\r\n        this.isPlayerStandUp = true;\r\n        this.curStandUpTime = 0;\r\n    },\r\n    sitDownEvent() {\r\n        var msg = {\r\n            action: GLB.SIT_DOWN\r\n        };\r\n        Game.GameManager.sendEventEx(msg);\r\n    },\r\n    sitDown() {\r\n        this.isPlayerStandUp = false;\r\n        this.hitButtonNode.active = true;\r\n        this.complacentButtonNode.active = false;\r\n    },\r\n    hitEvent() {\r\n        if (Game.GameManager.gameState !== GameState.Play) {\r\n            return;\r\n        }\r\n        if (this.isPersonAppear) {\r\n            var msg = {\r\n                action: GLB.STAND_UP\r\n            };\r\n        } else {\r\n            var msg = {\r\n                action: GLB.PLAYER_HIT\r\n            };\r\n        }\r\n        Game.GameManager.sendEventEx(msg);\r\n    },\r\n    hit() {\r\n        cc.audioEngine.play(this.hitAudio, false, 1);\r\n    },\r\n    complacentEvent() {\r\n        if (Game.GameManager.gameState !== GameState.Play) {\r\n            return;\r\n        }\r\n        var msg = {\r\n            action: GLB.COMPLACENT\r\n        };\r\n        Game.GameManager.sendEventEx(msg);\r\n    },\r\n    complacent() {\r\n        if (this.laughId) {\r\n            var state = cc.audioEngine.getState(this.laughId);\r\n            if (state === cc.audioEngine.AudioState.PLAYING) {\r\n                return;\r\n            }\r\n        }\r\n        this.laughId = cc.audioEngine.play(this.laughAudio, false, 1);\r\n    },\r\n\r\n    randomAppearRole() {\r\n        var num = Math.random();\r\n        var role = null;\r\n        if (num < 0.25) {\r\n            role = Appear_Role.Besom;\r\n        } else if (num < 0.5 && num >= 0.25) {\r\n            role = Appear_Role.Brother;\r\n        } else if (num < 0.75 && num >= 0.5) {\r\n            role = Appear_Role.Door;\r\n        } else {\r\n            role = Appear_Role.Teacher;\r\n        }\r\n        if (role === Appear_Role.Brother || role === Appear_Role.Teacher) {\r\n            if (role === this.curAppearRole) {\r\n                this.randomAppearRole();\r\n                return;\r\n            }\r\n        }\r\n        this.curAppearRole = role;\r\n        return role;\r\n    },\r\n    randomNumBoth(Min, Max) {\r\n        var Range = Max - Min;\r\n        var Rand = Math.random();\r\n        var num = Min + Math.round(Rand * Range); //四舍五入\r\n        return num;\r\n    },\r\n    appearRole() {\r\n        this.action = null;\r\n        var role = this.randomAppearRole();\r\n        if (role === Appear_Role.Besom) {\r\n            this.action = GLB.APPEAR_BESOM;\r\n        } else if (role === Appear_Role.Brother) {\r\n            this.action = GLB.APPEAR_BROTHER;\r\n        } else if (role === Appear_Role.Teacher) {\r\n            this.action = GLB.APPEAR_TEACHER;\r\n        } else if (role === Appear_Role.Door) {\r\n            this.action = GLB.HALF_OPEN_DOOR;\r\n        }\r\n        var msg = {\r\n            action: this.action\r\n        };\r\n        Game.GameManager.sendEventEx(msg);\r\n    },\r\n    appearBesom() {\r\n        this.isNeedTiming = false;\r\n        this.besomNode.active = true;\r\n        this.besomAnim.play(this.besomAnimName);\r\n        setTimeout(function() {\r\n            this.besomNode.active = false;\r\n        }.bind(this), 1000);\r\n    },\r\n    appearBrother() {\r\n        this.isNeedTiming = false;\r\n        var anim = this.brotherAnim.play(this.brotherAnimName);\r\n        anim.wrapMode = cc.WrapMode.Normal;\r\n        this.brotherAudio.play();\r\n        setTimeout(function() {\r\n            this.isPersonAppear = false;\r\n            var anim = this.brotherAnim.play(this.brotherAnimName);\r\n            anim.wrapMode = cc.WrapMode.Reverse;\r\n        }.bind(this), 2000)\r\n    },\r\n    halfOpenDoor() {\r\n        this.isNeedTiming = false;\r\n        this.teacherAnim.play(this.halfDoorAnimName);\r\n        setTimeout(function() {\r\n            if (Game.GameManager.gameState !== GameState.Over) {\r\n                cc.audioEngine.play(this.closeDoorSmall, false, 1);\r\n            }\r\n        }.bind(this), 1500);\r\n    },\r\n    appearTeacher() {\r\n        this.isNeedTiming = false;\r\n        this.teacherAnim.play(this.openDoorAnimName);\r\n        setTimeout(function() {\r\n            if (Game.GameManager.gameState !== GameState.Over) {\r\n                this.isPersonAppear = false;\r\n                this.teacherAnim.play(this.closeDoorAnimName);\r\n                cc.audioEngine.play(this.closeDoorAll, false, 1);\r\n            }\r\n        }.bind(this), 4000);\r\n        setTimeout(function() {\r\n            this.teacherAudio.play();\r\n        }.bind(this), 2000);\r\n    },\r\n    update(dt) {\r\n        if (GLB.isRoomOwner && Game.GameManager.gameState === GameState.Play) {\r\n            if (this.isPlayerStandUp) {\r\n                if (this.curStandUpTime >= this.totalStandUpTime) {\r\n                    // this.isPlayerStandUp = false;\r\n                    this.sitDownEvent();\r\n                } else {\r\n                    this.curStandUpTime += dt;\r\n                }\r\n            } else {\r\n                // if (!this.isNeedTiming) return;\r\n                if (this.curInterval >= this.totalInterval) {\r\n                    this.curInterval = 0;\r\n                    this.totalInterval = this.randomNumBoth(4, 6);\r\n                    this.appearRole();\r\n                    if (this.action === GLB.APPEAR_TEACHER) {\r\n                        this.totalInterval += 3;\r\n                    }\r\n                } else {\r\n                    this.curInterval += dt;\r\n                }\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    onDestroy() {\r\n\r\n        this.brotherAnim.off('finished', this.roleAlreadyAppear, this);\r\n        this.teacherAnim.off('finished', this.roleAlreadyAppear, this);\r\n        this.besomAnim.off('finished', this.roleAlreadyAppear, this);\r\n        clientEvent.off(clientEvent.eventType.appearBesom, this.appearBesom, this);\r\n        clientEvent.off(clientEvent.eventType.appearBrother, this.appearBrother, this);\r\n        clientEvent.off(clientEvent.eventType.appearTeacher, this.appearTeacher, this);\r\n        clientEvent.off(clientEvent.eventType.halfOpenDoor, this.halfOpenDoor, this);\r\n        clientEvent.off(clientEvent.eventType.standUpEvent, this.standUpEvent, this);\r\n        clientEvent.off(clientEvent.eventType.sitDown, this.sitDown, this);\r\n        clientEvent.off(clientEvent.eventType.showAddRedNum, this.showAddRedNum, this);\r\n        clientEvent.off(clientEvent.eventType.showReduceRedNum, this.showReduceRedNum, this);\r\n        clientEvent.off(clientEvent.eventType.showBlueAddNum, this.showBlueAddNum, this);\r\n        clientEvent.off(clientEvent.eventType.showReduceBlueNum, this.showReduceBlueNum, this);\r\n        clientEvent.off(clientEvent.eventType.hitEvent, this.hit, this);\r\n        clientEvent.off(clientEvent.eventType.complacentEvent, this.complacent, this);\r\n        clientEvent.off(clientEvent.eventType.gameOver, this.gameOver, this);\r\n        clientEvent.off(clientEvent.eventType.roundStart, this.roundStart, this);\r\n        clientEvent.off(clientEvent.eventType.leaveRoomNotify, this.leaveRoom, this);\r\n    }\r\n\r\n});\r\n"]}