{"version":3,"sources":["../../../../../assets/common/script/assets/common/script/uiGamePanel.js"],"names":["mvs","require","GLB","Appear_Role","None","Brother","Teacher","Besom","Door","cc","Class","extends","properties","hitAudio","default","url","AudioClip","laughAudio","closeDoorSmall","closeDoorAll","standUpAuido","besomNode","Node","brotherNode","teacherNode","shutDoorSprite","SpriteFrame","halfDoorSprite","hitButtonNode","complacentButtonNode","addRedPrefab","Prefab","reduceRedPrefab","addBluePrefab","reduceBluePrefab","redNumParent","blueNumParent","redScoreNode","blueScoreNode","timeNode","selfNode","otherNode","selfIcon","rivalIcon","onLoad","_super","curAppearRole","totalInterval","curInterval","besomAnim","getComponent","Animation","besomAnimName","brotherAnim","brotherAudio","AudioSource","brotherAnimName","teacherAnim","teacherAudio","halfDoorAnimName","openDoorAnimName","closeDoorAnimName","on","roleAlreadyAppear","redScoreLabel","Label","blueScoreLabel","timeLabel","clientEvent","eventType","appearBesom","appearBrother","appearTeacher","halfOpenDoor","standUpEvent","sitDown","showAddRedNum","showReduceRedNum","showBlueAddNum","showReduceBlueNum","hitEvent","hit","complacentEvent","complacent","gameOver","roundStart","leaveRoomNotify","leaveRoom","leaveRoomMedNotify","isPersonAppear","isNeedTiming","isPlayerStandUp","totalStandUpTime","curStandUpTime","addredNumPool","reduceRedNumPool","addBlueNumPool","reduceBlueNumPool","createPool","selfScore","otherScore","updateSelfScore","updateOtherScore","totalTime","curTime","timer","console","log","nodeDict","setData","id","playerUserIds","self","other","exit","data","Game","GameManager","gameState","GameState","Over","uiFunc","openUI","obj","uiTip","leaveRoomInfo","userId","userInfo","bind","play","setTimeout","countDownEvent","clearInterval","countDown","setInterval","Play","string","toString","isRoomOwner","msg","action","GAME_OVER_EVENT","sendEventEx","num","NodePool","i","addRedItem","instantiate","reduceRedItem","addBlueItem","reduceBlueItem","put","getPoolItem","pool","prefab","item","size","get","score","parent","init","event","detail","name","wrapMode","param","dispatch","standUpEventMed","playerState","Player_State","StandUp","active","sitDownEvent","SIT_DOWN","STAND_UP","PLAYER_HIT","audioEngine","COMPLACENT","laughId","state","getState","AudioState","PLAYING","randomAppearRole","Math","random","role","randomNumBoth","Min","Max","Range","Rand","round","appearRole","APPEAR_BESOM","APPEAR_BROTHER","APPEAR_TEACHER","HALF_OPEN_DOOR","anim","WrapMode","Normal","Reverse","update","dt","onDestroy","off"],"mappings":"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","file":"uiGamePanel.js","sourceRoot":"../../../../../assets/common/script","sourcesContent":["var mvs = require(\"Matchvs\");\nvar GLB = require(\"Glb\");\nvar Appear_Role = {\n    None: 0,\n    Brother: 1,\n    Teacher: 2,\n    Besom: 3,\n    Door: 4\n};\ncc.Class({\n    extends: require(\"uiPanel\"),\n\n    properties: {\n        hitAudio: {\n            default: null,\n            url: cc.AudioClip\n        },\n        laughAudio: {\n            default: null,\n            url: cc.AudioClip\n        },\n        closeDoorSmall: {\n            default: null,\n            url: cc.AudioClip\n        },\n        closeDoorAll: {\n            default: null,\n            url: cc.AudioClip\n        },\n        standUpAuido: {\n            default: null,\n            url: cc.AudioClip\n        },\n        besomNode: cc.Node,\n        brotherNode: cc.Node,\n        teacherNode: cc.Node,\n        shutDoorSprite: cc.SpriteFrame,\n        halfDoorSprite: cc.SpriteFrame,\n        hitButtonNode: cc.Node,\n        complacentButtonNode: cc.Node,\n        addRedPrefab: cc.Prefab,\n        reduceRedPrefab: cc.Prefab,\n        addBluePrefab: cc.Prefab,\n        reduceBluePrefab: cc.Prefab,\n        redNumParent: cc.Node,\n        blueNumParent: cc.Node,\n        redScoreNode: cc.Node,\n        blueScoreNode: cc.Node,\n        timeNode: cc.Node,\n        selfNode: cc.Node,\n        otherNode: cc.Node,\n        selfIcon: cc.Node,\n        rivalIcon: cc.Node\n    },\n\n    onLoad() {\n        this._super();\n        this.curAppearRole = Appear_Role.None;\n        this.totalInterval = 6;\n        this.curInterval = 0;\n        this.besomAnim = this.besomNode.getComponent(cc.Animation);\n        this.besomAnimName = 'broom';\n        this.brotherAnim = this.brotherNode.getComponent(cc.Animation);\n        this.brotherAudio = this.brotherNode.getComponent(cc.AudioSource);\n        this.brotherAnimName = 'teacherBro';\n        this.teacherAnim = this.teacherNode.getComponent(cc.Animation);\n        this.teacherAudio = this.teacherNode.getComponent(cc.AudioSource);\n\n        this.halfDoorAnimName = 'noOpen';\n        this.openDoorAnimName = 'openDoo';\n        this.closeDoorAnimName = 'close';\n\n        this.brotherAnim.on('finished', this.roleAlreadyAppear, this);\n        this.teacherAnim.on('finished', this.roleAlreadyAppear, this);\n        this.besomAnim.on('finished', this.roleAlreadyAppear, this);\n        this.redScoreLabel = this.redScoreNode.getComponent(cc.Label);\n        this.blueScoreLabel = this.blueScoreNode.getComponent(cc.Label);\n        this.timeLabel = this.timeNode.getComponent(cc.Label);\n        clientEvent.on(clientEvent.eventType.appearBesom, this.appearBesom, this);\n        clientEvent.on(clientEvent.eventType.appearBrother, this.appearBrother, this);\n        clientEvent.on(clientEvent.eventType.appearTeacher, this.appearTeacher, this);\n        clientEvent.on(clientEvent.eventType.halfOpenDoor, this.halfOpenDoor, this);\n        clientEvent.on(clientEvent.eventType.standUpEvent, this.standUpEvent, this);\n        clientEvent.on(clientEvent.eventType.sitDown, this.sitDown, this);\n        clientEvent.on(clientEvent.eventType.showAddRedNum, this.showAddRedNum, this);\n        clientEvent.on(clientEvent.eventType.showReduceRedNum, this.showReduceRedNum, this);\n        clientEvent.on(clientEvent.eventType.showBlueAddNum, this.showBlueAddNum, this);\n        clientEvent.on(clientEvent.eventType.showReduceBlueNum, this.showReduceBlueNum, this);\n        clientEvent.on(clientEvent.eventType.hitEvent, this.hit, this);\n        clientEvent.on(clientEvent.eventType.complacentEvent, this.complacent, this);\n        clientEvent.on(clientEvent.eventType.gameOver, this.gameOver, this);\n        clientEvent.on(clientEvent.eventType.roundStart, this.roundStart, this);\n        clientEvent.on(clientEvent.eventType.leaveRoomNotify, this.leaveRoom, this);\n        clientEvent.on(clientEvent.eventType.leaveRoomMedNotify, this.leaveRoom, this);\n\n        this.isPersonAppear = false;\n        this.isNeedTiming = true;\n        this.isPlayerStandUp = false;\n        this.totalStandUpTime = 3;\n        this.curStandUpTime = 0;\n        this.addredNumPool = null;\n        this.reduceRedNumPool = null;\n        this.addBlueNumPool = null;\n        this.reduceBlueNumPool = null;\n        this.createPool();\n        this.selfScore = 0;\n        this.otherScore = 0;\n        this.updateSelfScore(0);\n        this.updateOtherScore(0);\n        this.totalTime = 60;\n        this.curTime = 60;\n        this.timer = null;\n\n        console.log(\"----------------\");\n        console.log(this.nodeDict);\n        console.log(this.selfIcon);\n        this.selfIcon.getComponent('playerIcon').setData({id: GLB.playerUserIds[0]});\n        this.rivalIcon.getComponent('playerIcon').setData({id: GLB.playerUserIds[1]});\n        this.self = this.selfNode.getComponent('player');\n        this.other = this.otherNode.getComponent('player');\n\n        this.nodeDict[\"exit\"].on(\"click\", this.exit, this);\n    },\n\n    leaveRoom(data) {\n        if (Game.GameManager.gameState !== GameState.Over) {\n            uiFunc.openUI(\"uiTip\", function(obj) {\n                var uiTip = obj.getComponent(\"uiTip\");\n                if (uiTip) {\n                    if (data.leaveRoomInfo.userId !== GLB.userInfo.id) {\n                        uiTip.setData(\"对手离开了游戏\");\n                    }\n                }\n            }.bind(this));\n        }\n    },\n\n    roundStart: function() {\n        // 回合画面表现--\n        this.nodeDict['readyGo'].getComponent(cc.Animation).play();\n        this.nodeDict['readyGo'].getComponent(cc.AudioSource).play();\n\n        setTimeout(function() {\n            this.countDownEvent();\n        }.bind(this), 2500);\n    },\n\n    gameOver() {\n        this.nodeDict['gameOver'].getComponent(cc.Animation).play();\n        this.nodeDict['gameOver'].getComponent(cc.AudioSource).play();\n        clearInterval(this.timer);\n    },\n\n    exit() {\n        uiFunc.openUI(\"uiExit\");\n    },\n\n    countDownEvent() {\n        this.countDown();\n        this.timer = setInterval(this.countDown.bind(this), 1000);\n    },\n    countDown() {\n        if (Game.GameManager.gameState !== GameState.Play) {\n            clearInterval(this.timer);\n            return;\n        }\n        this.timeLabel.string = this.curTime.toString();\n        if (this.curTime <= 0) {\n            clearInterval(this.timer);\n            if (GLB.isRoomOwner && Game.GameManager.gameState === GameState.Play) {\n                var msg = {action: GLB.GAME_OVER_EVENT};\n                Game.GameManager.sendEventEx(msg);\n            }\n            return;\n        }\n        if (this.curTime === 10) {\n            this.nodeDict[\"countdown\"].getComponent(cc.Animation).play(\"countdown7\");\n        } else if (this.curTime === 3) {\n            this.nodeDict[\"countdown\"].getComponent(cc.Animation).play(\"countdown3\");\n        }\n        this.curTime--;\n    },\n    updateSelfScore(num) {\n        this.selfScore += num;\n        if (this.selfScore < 0) {\n            this.selfScore = 0;\n        }\n        this.blueScoreLabel.string = this.selfScore.toString();\n    },\n    updateOtherScore(num) {\n        this.otherScore += num;\n        if (this.otherScore < 0) {\n            this.otherScore = 0;\n        }\n        this.redScoreLabel.string = this.otherScore.toString();\n    },\n    createPool() {\n        this.addredNumPool = new cc.NodePool();\n        this.reduceRedNumPool = new cc.NodePool();\n        this.addBlueNumPool = new cc.NodePool();\n        this.reduceBlueNumPool = new cc.NodePool();\n        for (var i = 0; i < 10; i++) {\n            var addRedItem = cc.instantiate(this.addRedPrefab);\n            var reduceRedItem = cc.instantiate(this.reduceRedPrefab);\n            var addBlueItem = cc.instantiate(this.addBluePrefab);\n            var reduceBlueItem = cc.instantiate(this.reduceBluePrefab);\n            this.addredNumPool.put(addRedItem);\n            this.reduceRedNumPool.put(reduceRedItem);\n            this.addBlueNumPool.put(addBlueItem);\n            this.reduceBlueNumPool.put(reduceBlueItem);\n        }\n    },\n    getPoolItem(pool, prefab) {\n        var item = null;\n        if (pool.size() > 0) {\n            item = pool.get();\n        } else {\n            item = cc.instantiate(prefab);\n        }\n        return item;\n    },\n    showAddRedNum() {\n        var item = this.getPoolItem(this.addredNumPool, this.addRedPrefab);\n        var score = item.getComponent('updateScore');\n        item.parent = this.redNumParent;\n        score.init(this.addredNumPool);\n        this.updateOtherScore(1);\n    },\n    showReduceRedNum() {\n        var item = this.getPoolItem(this.reduceRedNumPool, this.reduceRedPrefab);\n        var score = item.getComponent('updateScore');\n        item.parent = this.redNumParent;\n        score.init(this.reduceRedNumPool);\n        this.updateOtherScore(-2);\n    },\n    showBlueAddNum() {\n        var item = this.getPoolItem(this.addBlueNumPool, this.addBluePrefab);\n        var score = item.getComponent('updateScore');\n        item.parent = this.blueNumParent;\n        score.init(this.addBlueNumPool);\n        this.updateSelfScore(1);\n    },\n    showReduceBlueNum() {\n        var item = this.getPoolItem(this.reduceBlueNumPool, this.reduceBluePrefab);\n        var score = item.getComponent('updateScore');\n        item.parent = this.blueNumParent;\n        score.init(this.reduceBlueNumPool);\n        this.updateSelfScore(-2);\n    },\n    roleAlreadyAppear(event) {\n        if (event.detail.name === this.openDoorAnimName || event.detail.name === this.brotherAnimName) {\n            if (event.detail.wrapMode === 1) {\n                this.isPersonAppear = true;\n            } else {\n                this.isNeedTiming = true;\n            }\n        }\n        if (event.detail.name === this.halfDoorAnimName || event.detail.name === this.besomAnimName) {\n            this.isNeedTiming = true;\n        }\n\n\n    },\n    standUpEvent(param) {\n        clientEvent.dispatch(clientEvent.eventType.standUpEventMed, param);\n        if (this.self.playerState === Player_State.StandUp) {\n            this.complacentButtonNode.active = false;\n        } else {\n            if (this.other.playerState === Player_State.StandUp) {\n                this.complacentButtonNode.active = true;\n            } else {\n                this.complacentButtonNode.active = false;\n            }\n        }\n        this.hitButtonNode.active = false;\n        this.isPlayerStandUp = true;\n        this.curStandUpTime = 0;\n    },\n    sitDownEvent() {\n        var msg = {\n            action: GLB.SIT_DOWN\n        };\n        Game.GameManager.sendEventEx(msg);\n    },\n    sitDown() {\n        this.isPlayerStandUp = false;\n        this.hitButtonNode.active = true;\n        this.complacentButtonNode.active = false;\n    },\n    hitEvent() {\n        if (Game.GameManager.gameState !== GameState.Play) {\n            return;\n        }\n        if (this.isPersonAppear) {\n            var msg = {\n                action: GLB.STAND_UP\n            };\n        } else {\n            var msg = {\n                action: GLB.PLAYER_HIT\n            };\n        }\n        Game.GameManager.sendEventEx(msg);\n    },\n    hit() {\n        cc.audioEngine.play(this.hitAudio, false, 1);\n    },\n    complacentEvent() {\n        if (Game.GameManager.gameState !== GameState.Play) {\n            return;\n        }\n        var msg = {\n            action: GLB.COMPLACENT\n        };\n        Game.GameManager.sendEventEx(msg);\n    },\n    complacent() {\n        if (this.laughId) {\n            var state = cc.audioEngine.getState(this.laughId);\n            if (state === cc.audioEngine.AudioState.PLAYING) {\n                return;\n            }\n        }\n        this.laughId = cc.audioEngine.play(this.laughAudio, false, 1);\n    },\n\n    randomAppearRole() {\n        var num = Math.random();\n        var role = null;\n        if (num < 0.25) {\n            role = Appear_Role.Besom;\n        } else if (num < 0.5 && num >= 0.25) {\n            role = Appear_Role.Brother;\n        } else if (num < 0.75 && num >= 0.5) {\n            role = Appear_Role.Door;\n        } else {\n            role = Appear_Role.Teacher;\n        }\n        if (role === Appear_Role.Brother || role === Appear_Role.Teacher) {\n            if (role === this.curAppearRole) {\n                this.randomAppearRole();\n                return;\n            }\n        }\n        this.curAppearRole = role;\n        return role;\n    },\n    randomNumBoth(Min, Max) {\n        var Range = Max - Min;\n        var Rand = Math.random();\n        var num = Min + Math.round(Rand * Range); //四舍五入\n        return num;\n    },\n    appearRole() {\n        this.action = null;\n        var role = this.randomAppearRole();\n        if (role === Appear_Role.Besom) {\n            this.action = GLB.APPEAR_BESOM;\n        } else if (role === Appear_Role.Brother) {\n            this.action = GLB.APPEAR_BROTHER;\n        } else if (role === Appear_Role.Teacher) {\n            this.action = GLB.APPEAR_TEACHER;\n        } else if (role === Appear_Role.Door) {\n            this.action = GLB.HALF_OPEN_DOOR;\n        }\n        var msg = {\n            action: this.action\n        };\n        Game.GameManager.sendEventEx(msg);\n    },\n    appearBesom() {\n        this.isNeedTiming = false;\n        this.besomNode.active = true;\n        this.besomAnim.play(this.besomAnimName);\n        setTimeout(function() {\n            this.besomNode.active = false;\n        }.bind(this), 1000);\n    },\n    appearBrother() {\n        this.isNeedTiming = false;\n        var anim = this.brotherAnim.play(this.brotherAnimName);\n        anim.wrapMode = cc.WrapMode.Normal;\n        this.brotherAudio.play();\n        setTimeout(function() {\n            this.isPersonAppear = false;\n            var anim = this.brotherAnim.play(this.brotherAnimName);\n            anim.wrapMode = cc.WrapMode.Reverse;\n        }.bind(this), 2000)\n    },\n    halfOpenDoor() {\n        this.isNeedTiming = false;\n        this.teacherAnim.play(this.halfDoorAnimName);\n        setTimeout(function() {\n            if (Game.GameManager.gameState !== GameState.Over) {\n                cc.audioEngine.play(this.closeDoorSmall, false, 1);\n            }\n        }.bind(this), 1500);\n    },\n    appearTeacher() {\n        this.isNeedTiming = false;\n        this.teacherAnim.play(this.openDoorAnimName);\n        setTimeout(function() {\n            if (Game.GameManager.gameState !== GameState.Over) {\n                this.isPersonAppear = false;\n                this.teacherAnim.play(this.closeDoorAnimName);\n                cc.audioEngine.play(this.closeDoorAll, false, 1);\n            }\n        }.bind(this), 4000);\n        setTimeout(function() {\n            this.teacherAudio.play();\n        }.bind(this), 2000);\n    },\n    update(dt) {\n        if (GLB.isRoomOwner && Game.GameManager.gameState === GameState.Play) {\n            if (this.isPlayerStandUp) {\n                if (this.curStandUpTime >= this.totalStandUpTime) {\n                    // this.isPlayerStandUp = false;\n                    this.sitDownEvent();\n                } else {\n                    this.curStandUpTime += dt;\n                }\n            } else {\n                // if (!this.isNeedTiming) return;\n                if (this.curInterval >= this.totalInterval) {\n                    this.curInterval = 0;\n                    this.totalInterval = this.randomNumBoth(4, 6);\n                    this.appearRole();\n                    if (this.action === GLB.APPEAR_TEACHER) {\n                        this.totalInterval += 3;\n                    }\n                } else {\n                    this.curInterval += dt;\n                }\n            }\n\n        }\n    },\n\n    onDestroy() {\n\n        this.brotherAnim.off('finished', this.roleAlreadyAppear, this);\n        this.teacherAnim.off('finished', this.roleAlreadyAppear, this);\n        this.besomAnim.off('finished', this.roleAlreadyAppear, this);\n        clientEvent.off(clientEvent.eventType.appearBesom, this.appearBesom, this);\n        clientEvent.off(clientEvent.eventType.appearBrother, this.appearBrother, this);\n        clientEvent.off(clientEvent.eventType.appearTeacher, this.appearTeacher, this);\n        clientEvent.off(clientEvent.eventType.halfOpenDoor, this.halfOpenDoor, this);\n        clientEvent.off(clientEvent.eventType.standUpEvent, this.standUpEvent, this);\n        clientEvent.off(clientEvent.eventType.sitDown, this.sitDown, this);\n        clientEvent.off(clientEvent.eventType.showAddRedNum, this.showAddRedNum, this);\n        clientEvent.off(clientEvent.eventType.showReduceRedNum, this.showReduceRedNum, this);\n        clientEvent.off(clientEvent.eventType.showBlueAddNum, this.showBlueAddNum, this);\n        clientEvent.off(clientEvent.eventType.showReduceBlueNum, this.showReduceBlueNum, this);\n        clientEvent.off(clientEvent.eventType.hitEvent, this.hit, this);\n        clientEvent.off(clientEvent.eventType.complacentEvent, this.complacent, this);\n        clientEvent.off(clientEvent.eventType.gameOver, this.gameOver, this);\n        clientEvent.off(clientEvent.eventType.roundStart, this.roundStart, this);\n        clientEvent.off(clientEvent.eventType.leaveRoomNotify, this.leaveRoom, this);\n        clientEvent.off(clientEvent.eventType.leaveRoomMedNotify, this.leaveRoom, this);\n\n    }\n\n});\n"]}