{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\common\\script/assets\\common\\script\\uiVsResult.js"],"names":["uiPanel","require","mvs","GLB","cc","Class","extends","properties","loseClip","default","url","AudioClip","victoryClip","start","player","nodeDict","getComponent","setData","playerUserIds","rival","active","gamePanel","uiFunc","findUI","gamePanelScript","selfScore","otherScore","isWin","audioEngine","play","Label","string","on","quit","Game","GameManager","loginServer","engine","leaveRoom","destroy","closeUI","node","name","lobbyShow"],"mappings":";;;;;;AAAA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;AACA,IAAIC,MAAMD,QAAQ,SAAR,CAAV;AACA,IAAIE,MAAMF,QAAQ,KAAR,CAAV;AACAG,GAAGC,KAAH,CAAS;AACLC,aAASN,OADJ;;AAGLO,gBAAY;AACRC,kBAAU;AACNC,qBAAS,IADH;AAENC,iBAAKN,GAAGO;AAFF,SADF;AAKRC,qBAAa;AACTH,qBAAS,IADA;AAETC,iBAAKN,GAAGO;AAFC;AALL,KAHP;;AAcLE,SAdK,mBAcG;AACJ,aAAKC,MAAL,GAAc,KAAKC,QAAL,CAAc,QAAd,EAAwBC,YAAxB,CAAqC,kBAArC,CAAd;AACA,aAAKF,MAAL,CAAYG,OAAZ,CAAoBd,IAAIe,aAAJ,CAAkB,CAAlB,CAApB;AACA,aAAKC,KAAL,GAAa,KAAKJ,QAAL,CAAc,OAAd,EAAuBC,YAAvB,CAAoC,kBAApC,CAAb;AACA,aAAKG,KAAL,CAAWF,OAAX,CAAmBd,IAAIe,aAAJ,CAAkB,CAAlB,CAAnB;AACA,aAAKH,QAAL,CAAc,IAAd,EAAoBK,MAApB,GAA6B,KAA7B;AACA,aAAKL,QAAL,CAAc,OAAd,EAAuBK,MAAvB,GAAgC,IAAhC;;AAEA,YAAIC,YAAYC,OAAOC,MAAP,CAAc,aAAd,CAAhB;AACA,YAAIF,SAAJ,EAAe;AACX,gBAAIG,kBAAkBH,UAAUL,YAAV,CAAuB,aAAvB,CAAtB;AACA,iBAAKS,SAAL,GAAiBD,gBAAgBC,SAAjC;AACA,iBAAKC,UAAL,GAAkBF,gBAAgBE,UAAlC;AACH;AACD,YAAI,KAAKD,SAAL,IAAkB,KAAKC,UAA3B,EAAuC;AACnC,iBAAKX,QAAL,CAAc,MAAd,EAAsBK,MAAtB,GAA+B,KAA/B;AACA,iBAAKL,QAAL,CAAc,KAAd,EAAqBK,MAArB,GAA8B,IAA9B;AACH,SAHD,MAGO;AACH,iBAAKL,QAAL,CAAc,MAAd,EAAsBK,MAAtB,GAA+B,IAA/B;AACA,iBAAKL,QAAL,CAAc,KAAd,EAAqBK,MAArB,GAA8B,KAA9B;AACH;AACD,YAAIO,QAAQ,KAAKF,SAAL,IAAkB,KAAKC,UAAnC;AACA,YAAIC,KAAJ,EAAW;AACPvB,eAAGwB,WAAH,CAAeC,IAAf,CAAoB,KAAKjB,WAAzB,EAAsC,KAAtC,EAA6C,CAA7C;AACH,SAFD,MAEO;AACHR,eAAGwB,WAAH,CAAeC,IAAf,CAAoB,KAAKrB,QAAzB,EAAmC,KAAnC,EAA0C,CAA1C;AACH;;AAED,aAAKO,QAAL,CAAc,aAAd,EAA6BC,YAA7B,CAA0CZ,GAAG0B,KAA7C,EAAoDC,MAApD,GAA6D,KAAKN,SAAlE;AACA,aAAKV,QAAL,CAAc,YAAd,EAA4BC,YAA5B,CAAyCZ,GAAG0B,KAA5C,EAAmDC,MAAnD,GAA4D,KAAKL,UAAjE;;AAEA,aAAKX,QAAL,CAAc,MAAd,EAAsBiB,EAAtB,CAAyB,OAAzB,EAAkC,KAAKC,IAAvC,EAA6C,IAA7C;;AAEA,YAAIN,KAAJ,EAAW;AACP;AACAO,iBAAKC,WAAL,CAAiBC,WAAjB;AACH;AACJ,KAnDI;;;AAqDLH,UAAM,gBAAW;AACb/B,YAAImC,MAAJ,CAAWC,SAAX,CAAqB,EAArB;AACA,YAAIjB,YAAYC,OAAOC,MAAP,CAAc,aAAd,CAAhB;AACA,YAAIF,SAAJ,EAAe;AACXA,sBAAUkB,OAAV;AACAjB,mBAAOkB,OAAP,CAAe,aAAf;AACH;AACDlB,eAAOkB,OAAP,CAAe,KAAKC,IAAL,CAAUC,IAAzB;AACA,aAAKD,IAAL,CAAUF,OAAV;;AAGAL,aAAKC,WAAL,CAAiBQ,SAAjB;AACH;AAjEI,CAAT","file":"uiVsResult.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\common\\script","sourcesContent":["var uiPanel = require(\"uiPanel\");\r\nvar mvs = require(\"Matchvs\");\r\nvar GLB = require(\"Glb\");\r\ncc.Class({\r\n    extends: uiPanel,\r\n\r\n    properties: {\r\n        loseClip: {\r\n            default: null,\r\n            url: cc.AudioClip\r\n        },\r\n        victoryClip: {\r\n            default: null,\r\n            url: cc.AudioClip\r\n        }\r\n    },\r\n\r\n    start() {\r\n        this.player = this.nodeDict[\"player\"].getComponent(\"resultPlayerIcon\");\r\n        this.player.setData(GLB.playerUserIds[0]);\r\n        this.rival = this.nodeDict[\"rival\"].getComponent(\"resultPlayerIcon\");\r\n        this.rival.setData(GLB.playerUserIds[1]);\r\n        this.nodeDict[\"vs\"].active = false;\r\n        this.nodeDict[\"score\"].active = true;\r\n\r\n        var gamePanel = uiFunc.findUI(\"uiGamePanel\");\r\n        if (gamePanel) {\r\n            var gamePanelScript = gamePanel.getComponent(\"uiGamePanel\");\r\n            this.selfScore = gamePanelScript.selfScore;\r\n            this.otherScore = gamePanelScript.otherScore;\r\n        }\r\n        if (this.selfScore >= this.otherScore) {\r\n            this.nodeDict[\"lose\"].active = false;\r\n            this.nodeDict[\"win\"].active = true;\r\n        } else {\r\n            this.nodeDict[\"lose\"].active = true;\r\n            this.nodeDict[\"win\"].active = false;\r\n        }\r\n        var isWin = this.selfScore >= this.otherScore;\r\n        if (isWin) {\r\n            cc.audioEngine.play(this.victoryClip, false, 1);\r\n        } else {\r\n            cc.audioEngine.play(this.loseClip, false, 1);\r\n        }\r\n\r\n        this.nodeDict[\"playerScore\"].getComponent(cc.Label).string = this.selfScore;\r\n        this.nodeDict[\"rivalScore\"].getComponent(cc.Label).string = this.otherScore;\r\n\r\n        this.nodeDict[\"quit\"].on(\"click\", this.quit, this);\r\n\r\n        if (isWin) {\r\n            // 发送胜局记录--\r\n            Game.GameManager.loginServer();\r\n        }\r\n    },\r\n\r\n    quit: function() {\r\n        mvs.engine.leaveRoom(\"\");\r\n        var gamePanel = uiFunc.findUI(\"uiGamePanel\");\r\n        if (gamePanel) {\r\n            gamePanel.destroy();\r\n            uiFunc.closeUI(\"uiGamePanel\");\r\n        }\r\n        uiFunc.closeUI(this.node.name);\r\n        this.node.destroy();\r\n\r\n\r\n        Game.GameManager.lobbyShow();\r\n    }\r\n});\r\n"]}