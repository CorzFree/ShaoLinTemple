{"version":3,"sources":["../../../../../assets/common/script/assets/common/script/uiVsResult.js"],"names":["uiPanel","require","mvs","GLB","cc","Class","extends","properties","loseClip","default","url","AudioClip","victoryClip","start","player","nodeDict","getComponent","setData","playerUserIds","rival","active","gamePanel","uiFunc","findUI","gamePanelScript","selfScore","otherScore","isWin","audioEngine","play","Label","string","on","quit","Game","GameManager","loginServer","engine","leaveRoom","destroy","closeUI","node","name","lobbyShow"],"mappings":"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","file":"uiVsResult.js","sourceRoot":"../../../../../assets/common/script","sourcesContent":["var uiPanel = require(\"uiPanel\");\nvar mvs = require(\"Matchvs\");\nvar GLB = require(\"Glb\");\ncc.Class({\n    extends: uiPanel,\n\n    properties: {\n        loseClip: {\n            default: null,\n            url: cc.AudioClip\n        },\n        victoryClip: {\n            default: null,\n            url: cc.AudioClip\n        }\n    },\n\n    start() {\n        this.player = this.nodeDict[\"player\"].getComponent(\"resultPlayerIcon\");\n        this.player.setData(GLB.playerUserIds[0]);\n        this.rival = this.nodeDict[\"rival\"].getComponent(\"resultPlayerIcon\");\n        this.rival.setData(GLB.playerUserIds[1]);\n        this.nodeDict[\"vs\"].active = false;\n        this.nodeDict[\"score\"].active = true;\n\n        var gamePanel = uiFunc.findUI(\"uiGamePanel\");\n        if (gamePanel) {\n            var gamePanelScript = gamePanel.getComponent(\"uiGamePanel\");\n            this.selfScore = gamePanelScript.selfScore;\n            this.otherScore = gamePanelScript.otherScore;\n        }\n        if (this.selfScore >= this.otherScore) {\n            this.nodeDict[\"lose\"].active = false;\n            this.nodeDict[\"win\"].active = true;\n        } else {\n            this.nodeDict[\"lose\"].active = true;\n            this.nodeDict[\"win\"].active = false;\n        }\n        var isWin = this.selfScore >= this.otherScore;\n        if (isWin) {\n            cc.audioEngine.play(this.victoryClip, false, 1);\n        } else {\n            cc.audioEngine.play(this.loseClip, false, 1);\n        }\n\n        this.nodeDict[\"playerScore\"].getComponent(cc.Label).string = this.selfScore;\n        this.nodeDict[\"rivalScore\"].getComponent(cc.Label).string = this.otherScore;\n\n        this.nodeDict[\"quit\"].on(\"click\", this.quit, this);\n\n        if (isWin) {\n            // 发送胜局记录--\n            Game.GameManager.loginServer();\n        }\n    },\n\n    quit: function() {\n        mvs.engine.leaveRoom(\"\");\n        var gamePanel = uiFunc.findUI(\"uiGamePanel\");\n        if (gamePanel) {\n            gamePanel.destroy();\n            uiFunc.closeUI(\"uiGamePanel\");\n        }\n        uiFunc.closeUI(this.node.name);\n        this.node.destroy();\n\n\n        Game.GameManager.lobbyShow();\n    }\n});\n"]}