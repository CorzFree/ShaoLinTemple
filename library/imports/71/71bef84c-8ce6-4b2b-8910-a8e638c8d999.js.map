{"version":3,"sources":["../../../../../assets/common/script/assets/common/script/gameManager.js"],"names":["mvs","require","GLB","cc","Class","extends","Component","onLoad","Game","GameManager","game","addPersistRootNode","node","clientEvent","init","dataFunc","loadConfigs","view","enableAutoFullScreen","on","eventType","gameOver","leaveRoomNotify","leaveRoom","network","window","chooseNetworkMode","getRankDataListener","findPlayerByAccountListener","data","gameState","GameState","Play","userInfo","id","leaveRoomInfo","userId","isRoomOwner","Over","console","log","dispatch","setTimeout","Canvas","instance","designResolution","height","width","uiFunc","openUI","bind","matchVsInit","response","initResponse","errorResponse","joinRoomResponse","joinRoomNotify","leaveRoomResponse","joinOverResponse","createRoomResponse","getRoomListResponse","getRoomDetailResponse","getRoomListExResponse","kickPlayerResponse","kickPlayerNotify","registerUserResponse","loginResponse","logoutResponse","sendEventNotify","result","engine","channel","platform","gameId","kickPlayerRsp","status","rsp","roomInfos","joinOverRsp","roomUserInfoList","roomInfo","roomUserInfo","leaveRoomRsp","removePersistRootNode","director","loadScene","error","msg","obj","uiTip","getComponent","setData","logout","registerUser","deviceId","gatewayId","login","token","gameVersion","appKey","secret","info","lobbyShow","None","cpProto","JSON","parse","indexOf","GAME_START_EVENT","playerUserIds","remoteUserIds","userIds","forEach","push","startGame","PLAYER_HIT","param","ID","srcUserId","hitEvent","showBlueAddNum","showAddRedNum","STAND_UP","standUpEvent","COMPLACENT","complacentEvent","showReduceRedNum","showReduceBlueNum","SIT_DOWN","sitDown","GAME_OVER_EVENT","APPEAR_BESOM","appearBesom","APPEAR_BROTHER","appearBrother","APPEAR_TEACHER","appearTeacher","HALF_OPEN_DOOR","halfOpenDoor","READY","readyCnt","length","sendRoundStartMsg","ROUND_START","roundStart","sendReadyMsg","action","sendEventEx","stringify","sendEvent","recvMsg","uiRankPanel","rankArray","playerAccountGet","loginServer","isConnected","connect","IP","PORT","send","nickName","avatarUrl","userInfoReq","onDestroy","off"],"mappings":"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","file":"gameManager.js","sourceRoot":"../../../../../assets/common/script","sourcesContent":["var mvs = require(\"Matchvs\");\nvar GLB = require(\"Glb\");\n\ncc.Class({\n    extends: cc.Component,\n    onLoad() {\n        Game.GameManager = this;\n        cc.game.addPersistRootNode(this.node);\n        clientEvent.init();\n        dataFunc.loadConfigs();\n        cc.view.enableAutoFullScreen(false);\n        clientEvent.on(clientEvent.eventType.gameOver, this.gameOver, this);\n        clientEvent.on(clientEvent.eventType.leaveRoomNotify, this.leaveRoom, this);\n        this.network = window.network;\n        this.network.chooseNetworkMode();\n        this.getRankDataListener();\n        this.findPlayerByAccountListener();\n/*\n            wx.login({\n                success: function() {\n                    wx.getUserInfo({\n                        fail: function(res) {\n                            // iOS 和 Android 对于拒绝授权的回调 errMsg 没有统一，需要做一下兼容处理\n                            if (res.errMsg.indexOf('auth deny') > -1 || res.errMsg.indexOf('auth denied') > -1) {\n                                // 处理用户拒绝授权的情况\n                            }\n                        },\n                        success: function(res) {\n                            Game.GameManager.nickName = res.userInfo.nickName;\n                            Game.GameManager.avatarUrl = res.userInfo.avatarUrl;\n                            console.log('success', Game.GameManager.nickName);\n                        }\n                    });\n                }\n            })\n        }\n        */\n    },\n\n    leaveRoom: function(data) {\n        // 离开房间--\n        if (this.gameState === GameState.Play) {\n            if (GLB.userInfo.id !== data.leaveRoomInfo.userId) {\n                GLB.isRoomOwner = true;\n                // var gamePanel = uiFunc.findUI(\"uiGamePanel\");\n                // if (gamePanel) {\n                //     var gamePanelScript = gamePanel.getComponent(\"uiGamePanel\");\n                //     gamePanelScript.otherScore = 0;\n                //     this.gameOver();\n                // }\n            }\n            else {\n                Game.GameManager.gameState = GameState.Over;\n            }\n        }\n    },\n\n    gameOver: function() {\n        console.log(\"游戏结束\");\n        if (Game.GameManager.gameState !== GameState.Over) {\n            Game.GameManager.gameState = GameState.Over;\n            clientEvent.dispatch(clientEvent.eventType.gameOver);\n            setTimeout(function() {\n                if (cc.Canvas.instance.designResolution.height > cc.Canvas.instance.designResolution.width) {\n                    uiFunc.openUI(\"uiVsResultVer\");\n                } else {\n                    uiFunc.openUI(\"uiVsResult\");\n                }\n            }.bind(this), 1500);\n        }\n    },\n\n    matchVsInit: function() {\n        mvs.response.initResponse = this.initResponse.bind(this);\n        mvs.response.errorResponse = this.errorResponse.bind(this);\n        mvs.response.joinRoomResponse = this.joinRoomResponse.bind(this);\n        mvs.response.joinRoomNotify = this.joinRoomNotify.bind(this);\n        mvs.response.leaveRoomResponse = this.leaveRoomResponse.bind(this);\n        mvs.response.leaveRoomNotify = this.leaveRoomNotify.bind(this);\n        mvs.response.joinOverResponse = this.joinOverResponse.bind(this);\n        mvs.response.createRoomResponse = this.createRoomResponse.bind(this);\n        mvs.response.getRoomListResponse = this.getRoomListResponse.bind(this);\n        mvs.response.getRoomDetailResponse = this.getRoomDetailResponse.bind(this);\n        mvs.response.getRoomListExResponse = this.getRoomListExResponse.bind(this);\n        mvs.response.kickPlayerResponse = this.kickPlayerResponse.bind(this);\n        mvs.response.kickPlayerNotify = this.kickPlayerNotify.bind(this);\n        mvs.response.registerUserResponse = this.registerUserResponse.bind(this);\n        mvs.response.loginResponse = this.loginResponse.bind(this); // 用户登录之后的回调\n        mvs.response.logoutResponse = this.logoutResponse.bind(this); // 用户登录之后的回调\n        mvs.response.sendEventNotify = this.sendEventNotify.bind(this);\n\n        var result = mvs.engine.init(mvs.response, GLB.channel, GLB.platform, GLB.gameId);\n        if (result !== 0) {\n            console.log('初始化失败,错误码:' + result);\n        }\n    },\n\n    kickPlayerNotify: function(kickPlayerNotify) {\n        var data = {\n            kickPlayerNotify: kickPlayerNotify\n        }\n        clientEvent.dispatch(clientEvent.eventType.kickPlayerNotify, data);\n    },\n\n    kickPlayerResponse: function(kickPlayerRsp) {\n        if (kickPlayerRsp.status !== 200) {\n            console.log(\"失败kickPlayerRsp:\" + kickPlayerRsp);\n            return;\n        }\n        var data = {\n            kickPlayerRsp: kickPlayerRsp\n        }\n        clientEvent.dispatch(clientEvent.eventType.kickPlayerResponse, data);\n    },\n\n    getRoomListExResponse: function(rsp) {\n        if (rsp.status !== 200) {\n            console.log(\"失败 rsp:\" + rsp);\n            return;\n        }\n        var data = {\n            rsp: rsp\n        }\n        clientEvent.dispatch(clientEvent.eventType.getRoomListExResponse, data);\n    },\n\n    getRoomDetailResponse: function(rsp) {\n        if (rsp.status !== 200) {\n            console.log(\"失败 rsp:\" + rsp);\n            return;\n        }\n        var data = {\n            rsp: rsp\n        }\n        clientEvent.dispatch(clientEvent.eventType.getRoomDetailResponse, data);\n    },\n\n    getRoomListResponse: function(status, roomInfos) {\n        if (status !== 200) {\n            console.log(\"失败 status:\" + status);\n            return;\n        }\n        var data = {\n            status: status,\n            roomInfos: roomInfos\n        }\n        clientEvent.dispatch(clientEvent.eventType.getRoomListResponse, data);\n    },\n\n    createRoomResponse: function(rsp) {\n        if (rsp.status !== 200) {\n            console.log(\"失败 createRoomResponse:\" + rsp);\n            return;\n        }\n        var data = {\n            rsp: rsp\n        }\n        clientEvent.dispatch(clientEvent.eventType.createRoomResponse, data);\n    },\n\n    joinOverResponse: function(joinOverRsp) {\n        if (joinOverRsp.status !== 200) {\n            console.log(\"失败 joinOverRsp:\" + joinOverRsp);\n            return;\n        }\n        var data = {\n            joinOverRsp: joinOverRsp\n        }\n        clientEvent.dispatch(clientEvent.eventType.joinOverResponse, data);\n    },\n\n    joinRoomResponse: function(status, roomUserInfoList, roomInfo) {\n        if (status !== 200) {\n            console.log(\"失败 joinRoomResponse:\" + status);\n            return;\n        }\n        var data = {\n            status: status,\n            roomUserInfoList: roomUserInfoList,\n            roomInfo: roomInfo\n        }\n        clientEvent.dispatch(clientEvent.eventType.joinRoomResponse, data);\n    },\n\n    joinRoomNotify: function(roomUserInfo) {\n        var data = {\n            roomUserInfo: roomUserInfo\n        }\n        clientEvent.dispatch(clientEvent.eventType.joinRoomNotify, data);\n    },\n\n    leaveRoomResponse: function(leaveRoomRsp) {\n        if (leaveRoomRsp.status !== 200) {\n            console.log(\"失败 leaveRoomRsp:\" + leaveRoomRsp);\n            return;\n        }\n        var data = {\n            leaveRoomRsp: leaveRoomRsp\n        }\n        clientEvent.dispatch(clientEvent.eventType.leaveRoomResponse, data);\n    },\n\n    leaveRoomNotify: function(leaveRoomInfo) {\n        var data = {\n            leaveRoomInfo: leaveRoomInfo\n        }\n        clientEvent.dispatch(clientEvent.eventType.leaveRoomNotify, data);\n    },\n\n    logoutResponse: function(status) {\n        cc.game.removePersistRootNode(this.node);\n        cc.director.loadScene('lobby');\n    },\n\n    errorResponse: function(error, msg) {\n        if (error === 1001) {\n            uiFunc.openUI(\"uiTip\", function(obj) {\n                var uiTip = obj.getComponent(\"uiTip\");\n                if (uiTip) {\n                    uiTip.setData(\"网络断开连接\");\n                }\n            });\n            setTimeout(function() {\n                mvs.engine.logout(\"\");\n                cc.game.removePersistRootNode(this.node);\n                cc.director.loadScene('lobby');\n            }.bind(this), 2500);\n        }\n        console.log(\"错误信息：\" + error);\n        console.log(\"错误信息：\" + msg);\n    },\n\n    initResponse: function() {\n        console.log('初始化成功，开始注册用户');\n        var result = mvs.engine.registerUser();\n        if (result !== 0) {\n            console.log('注册用户失败，错误码:' + result);\n        } else {\n            console.log('注册用户成功');\n        }\n    },\n\n    registerUserResponse: function(userInfo) {\n        var deviceId = 'abcdef';\n        var gatewayId = 0;\n        GLB.userInfo = userInfo;\n\n        console.log('开始登录,用户Id:' + userInfo.id)\n\n        var result = mvs.engine.login(\n            userInfo.id, userInfo.token,\n            GLB.gameId, GLB.gameVersion,\n            GLB.appKey, GLB.secret,\n            deviceId, gatewayId\n        );\n        if (result !== 0) {\n            console.log('登录失败,错误码:' + result);\n        }\n    },\n\n    loginResponse: function(info) {\n        if (info.status !== 200) {\n            console.log('登录失败,异步回调错误码:' + info.status);\n        } else {\n            console.log('登录成功');\n            this.lobbyShow();\n        }\n    },\n\n    lobbyShow: function() {\n        this.gameState = GameState.None;\n        if (cc.Canvas.instance.designResolution.height > cc.Canvas.instance.designResolution.width) {\n            uiFunc.openUI(\"uiLobbyPanelVer\");\n        } else {\n            uiFunc.openUI(\"uiLobbyPanel\");\n        }\n    },\n\n    // 收到的消息\n    sendEventNotify: function(info) {\n        console.log(info)\n        var cpProto = JSON.parse(info.cpProto);\n        if (info.cpProto.indexOf(GLB.GAME_START_EVENT) >= 0) {\n            GLB.playerUserIds = [GLB.userInfo.id]\n            var remoteUserIds = JSON.parse(info.cpProto).userIds;\n            remoteUserIds.forEach(function(id) {\n                if (GLB.userInfo.id !== id) {\n                    GLB.playerUserIds.push(id);\n                }\n            });\n            this.startGame();\n        }\n\n\n        if (info.cpProto.indexOf(GLB.PLAYER_HIT) >= 0) {\n            var param = {\n                ID: (info.srcUserId == GLB.userInfo.id) ? 0 : 1\n            }\n            clientEvent.dispatch(clientEvent.eventType.hitEvent, param);\n            // Game.PlayerManager.rival.PLAYER_HIT();\n            if (info.srcUserId == GLB.userInfo.id) {\n                clientEvent.dispatch(clientEvent.eventType.showBlueAddNum);\n            } else {\n                clientEvent.dispatch(clientEvent.eventType.showAddRedNum);\n            }\n\n        }\n        if (info.cpProto.indexOf(GLB.STAND_UP) >= 0) {\n            var param = {\n                ID: (info.srcUserId == GLB.userInfo.id) ? 0 : 1\n            }\n            clientEvent.dispatch(clientEvent.eventType.standUpEvent, param);\n\n        }\n        if (info.cpProto.indexOf(GLB.COMPLACENT) >= 0) {\n            var param = {\n                ID: (info.srcUserId == GLB.userInfo.id) ? 0 : 1\n            }\n            clientEvent.dispatch(clientEvent.eventType.complacentEvent, param);\n            if (info.srcUserId == GLB.userInfo.id) {\n                clientEvent.dispatch(clientEvent.eventType.showReduceRedNum);\n            } else {\n                clientEvent.dispatch(clientEvent.eventType.showReduceBlueNum);\n            }\n        }\n        if (info.cpProto.indexOf(GLB.SIT_DOWN) >= 0) {\n            clientEvent.dispatch(clientEvent.eventType.sitDown);\n        }\n        if (info.cpProto.indexOf(GLB.GAME_OVER_EVENT) >= 0) {\n            this.gameOver();\n        }\n        if (info.cpProto.indexOf(GLB.APPEAR_BESOM) >= 0) {\n            clientEvent.dispatch(clientEvent.eventType.appearBesom);\n\n        }\n        if (info.cpProto.indexOf(GLB.APPEAR_BROTHER) >= 0) {\n            clientEvent.dispatch(clientEvent.eventType.appearBrother);\n        }\n        if (info.cpProto.indexOf(GLB.APPEAR_TEACHER) >= 0) {\n            clientEvent.dispatch(clientEvent.eventType.appearTeacher);\n        }\n        if (info.cpProto.indexOf(GLB.HALF_OPEN_DOOR) >= 0) {\n            clientEvent.dispatch(clientEvent.eventType.halfOpenDoor);\n        }\n\n        if (info.cpProto.indexOf(GLB.READY) >= 0) {\n            this.readyCnt++;\n            if (GLB.isRoomOwner && this.readyCnt >= GLB.playerUserIds.length) {\n                this.sendRoundStartMsg();\n            }\n        }\n\n        if (info.cpProto.indexOf(GLB.ROUND_START) >= 0) {\n            setTimeout(function() {\n                Game.GameManager.gameState = GameState.Play;\n            }.bind(this), 2000);\n            clientEvent.dispatch(clientEvent.eventType.roundStart);\n        }\n    },\n\n    sendReadyMsg: function() {\n        var msg = {action: GLB.READY};\n        this.sendEventEx(msg);\n    },\n\n    sendRoundStartMsg: function() {\n        var msg = {action: GLB.ROUND_START};\n        this.sendEventEx(msg);\n    },\n\n    sendEventEx: function(msg) {\n        var result = mvs.engine.sendEventEx(0, JSON.stringify(msg), 0, GLB.playerUserIds);\n        if (result.result !== 0) {\n            console.log(msg.action, result.result);\n        }\n    },\n\n    sendEvent: function(msg) {\n        var result = mvs.engine.sendEvent(JSON.stringify(msg));\n        if (result.result !== 0) {\n            console.log(msg.action, result.result);\n        }\n    },\n\n    startGame: function() {\n        this.readyCnt = 0;\n        cc.director.loadScene('game', function() {\n            uiFunc.openUI(\"uiGamePanel\", function() {\n                this.sendReadyMsg();\n            }.bind(this));\n        }.bind(this));\n    },\n\n    getRankDataListener: function() {\n        this.network.on(\"connector.rankHandler.getRankData\", function(recvMsg) {\n            uiFunc.openUI(\"uiRankPanelVer\", function(obj) {\n                var uiRankPanel = obj.getComponent(\"uiRankPanel\");\n                uiRankPanel.setData(recvMsg.rankArray);\n            });\n        }.bind(this));\n    },\n\n    findPlayerByAccountListener: function() {\n        this.network.on(\"connector.entryHandler.findPlayerByAccount\", function(recvMsg) {\n            clientEvent.dispatch(clientEvent.eventType.playerAccountGet, recvMsg);\n        });\n    },\n\n    loginServer: function() {\n        if (!this.network.isConnected()) {\n            this.network.connect(GLB.IP, GLB.PORT, function() {\n                    this.network.send(\"connector.entryHandler.login\", {\n                        \"account\": GLB.userInfo.id + \"\",\n                        \"channel\": \"0\",\n                        \"userName\": Game.GameManager.nickName ? Game.GameManager.nickName : GLB.userInfo.id + \"\",\n                        \"headIcon\": Game.GameManager.avatarUrl ? Game.GameManager.avatarUrl : \"-\"\n                    });\n                    setTimeout(function() {\n                        this.network.send(\"connector.rankHandler.updateScore\", {\n                            \"account\": GLB.userInfo.id + \"\",\n                            \"game\": \"game1\"\n                        });\n                    }.bind(this), 500);\n\n                }.bind(this)\n            );\n        } else {\n            this.network.send(\"connector.rankHandler.updateScore\", {\n                \"account\": GLB.userInfo.id + \"\",\n                \"game\": \"game1\"\n            });\n        }\n    },\n\n    userInfoReq: function(userId) {\n        if (!Game.GameManager.network.isConnected()) {\n            Game.GameManager.network.connect(GLB.IP, GLB.PORT, function() {\n                    Game.GameManager.network.send(\"connector.entryHandler.login\", {\n                        \"account\": GLB.userInfo.id + \"\",\n                        \"channel\": \"0\",\n                        \"userName\": Game.GameManager.nickName ? Game.GameManager.nickName : GLB.userInfo.id + \"\",\n                        \"headIcon\": Game.GameManager.avatarUrl ? Game.GameManager.avatarUrl : \"-\"\n                    });\n                    setTimeout(function() {\n                        Game.GameManager.network.send(\"connector.entryHandler.findPlayerByAccount\", {\n                            \"account\": userId + \"\",\n                        });\n                    }, 200);\n                }\n            );\n        } else {\n            Game.GameManager.network.send(\"connector.entryHandler.findPlayerByAccount\", {\n                \"account\": userId + \"\",\n            });\n        }\n    },\n\n    onDestroy() {\n        clientEvent.off(clientEvent.eventType.gameOver, this.gameOver, this);\n        clientEvent.off(clientEvent.eventType.leaveRoomNotify, this.leaveRoom, this);\n    }\n});\n"]}